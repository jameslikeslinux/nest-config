---
nest::classes:
  - 'nest::service::gitlab_runner'
  - 'nest::tool::qemu'

nest::kernel_config:
  CONFIG_EXTRA_FIRMWARE: >-
    amdgpu/gc_11_0_2_imu.bin
    amdgpu/gc_11_0_2_me.bin
    amdgpu/gc_11_0_2_mec.bin
    amdgpu/gc_11_0_2_mes1.bin
    amdgpu/gc_11_0_2_mes_2.bin
    amdgpu/gc_11_0_2_mes.bin
    amdgpu/gc_11_0_2_pfp.bin
    amdgpu/gc_11_0_2_rlc.bin
    amdgpu/psp_13_0_7_sos.bin
    amdgpu/psp_13_0_7_ta.bin
    amdgpu/smu_13_0_7.bin

nest::service::gitlab_runner::host: 'gitlab.james.tl'
nest::service::gitlab_runner::instances:
  builder:
    limit: 2
    privileged: true
    security_options: ['seccomp=unconfined']
    volumes:
      - '/nest:/nest'
      - '/falcon:/falcon'
      - '/usr/bin/qemu-aarch64:/usr/bin/qemu-aarch64:ro'
      - '/usr/bin/qemu-arm:/usr/bin/qemu-arm:ro'
      - '/usr/bin/qemu-riscv64:/usr/bin/qemu-riscv64:ro'
      - '/usr/bin/qemu-x86_64:/usr/bin/qemu-x86_64:ro'
    zfs: true
