---
nest::classes:
  - 'nest::service::gitlab_runner'
  - 'nest::tool::qemu'

nest::dvorak: true
nest::monitor_layout: ['DP-3@0', 'HDMI-1@2560']
nest::primary_monitor: 'HDMI-1'
nest::text_scaling_factor: 1.1
nest::vpn_client: false

nest::service::gitlab_runner::host: 'gitlab.james.tl'
nest::service::gitlab_runner::instances:
  builder:
    limit: 2
    privileged: true
    security_options: ['seccomp=unconfined']
    volumes:
      - '/nest:/nest'
      - '/falcon:/falcon'
      - '/usr/bin/qemu-aarch64:/usr/bin/qemu-aarch64:ro'
      - '/usr/bin/qemu-arm:/usr/bin/qemu-arm:ro'
      - '/usr/bin/qemu-riscv64:/usr/bin/qemu-riscv64:ro'
      - '/usr/bin/qemu-x86_64:/usr/bin/qemu-x86_64:ro'
    zfs: true

nest::kernel_config:
  # Build in Navi 3x firmware for early boot framebuffer
  # See: https://wiki.gentoo.org/wiki/AMDGPU#Incorporating_firmware
  CONFIG_EXTRA_FIRMWARE: >-
    amdgpu/dcn_3_1_4_dmcub.bin
    amdgpu/dcn_3_1_5_dmcub.bin
    amdgpu/dcn_3_1_6_dmcub.bin
    amdgpu/dcn_3_2_0_dmcub.bin
    amdgpu/dcn_3_2_1_dmcub.bin
    amdgpu/gc_10_3_6_ce.bin
    amdgpu/gc_10_3_6_me.bin
    amdgpu/gc_10_3_6_mec2.bin
    amdgpu/gc_10_3_6_mec.bin
    amdgpu/gc_10_3_6_pfp.bin
    amdgpu/gc_10_3_6_rlc.bin
    amdgpu/gc_10_3_7_ce.bin
    amdgpu/gc_10_3_7_me.bin
    amdgpu/gc_10_3_7_mec2.bin
    amdgpu/gc_10_3_7_mec.bin
    amdgpu/gc_10_3_7_pfp.bin
    amdgpu/gc_10_3_7_rlc.bin
    amdgpu/gc_11_0_0_imu.bin
    amdgpu/gc_11_0_0_me.bin
    amdgpu/gc_11_0_0_mec.bin
    amdgpu/gc_11_0_0_mes1.bin
    amdgpu/gc_11_0_0_mes_2.bin
    amdgpu/gc_11_0_0_mes.bin
    amdgpu/gc_11_0_0_pfp.bin
    amdgpu/gc_11_0_0_rlc_1.bin
    amdgpu/gc_11_0_0_rlc.bin
    amdgpu/gc_11_0_1_imu.bin
    amdgpu/gc_11_0_1_me.bin
    amdgpu/gc_11_0_1_mec.bin
    amdgpu/gc_11_0_1_mes1.bin
    amdgpu/gc_11_0_1_mes_2.bin
    amdgpu/gc_11_0_1_mes.bin
    amdgpu/gc_11_0_1_pfp.bin
    amdgpu/gc_11_0_1_rlc.bin
    amdgpu/gc_11_0_2_imu.bin
    amdgpu/gc_11_0_2_me.bin
    amdgpu/gc_11_0_2_mec.bin
    amdgpu/gc_11_0_2_mes1.bin
    amdgpu/gc_11_0_2_mes_2.bin
    amdgpu/gc_11_0_2_mes.bin
    amdgpu/gc_11_0_2_pfp.bin
    amdgpu/gc_11_0_2_rlc.bin
    amdgpu/gc_11_0_3_imu.bin
    amdgpu/gc_11_0_3_me.bin
    amdgpu/gc_11_0_3_mec.bin
    amdgpu/gc_11_0_3_mes1.bin
    amdgpu/gc_11_0_3_mes_2.bin
    amdgpu/gc_11_0_3_pfp.bin
    amdgpu/gc_11_0_3_rlc.bin
    amdgpu/gc_11_0_4_imu.bin
    amdgpu/gc_11_0_4_me.bin
    amdgpu/gc_11_0_4_mec.bin
    amdgpu/gc_11_0_4_mes1.bin
    amdgpu/gc_11_0_4_mes_2.bin
    amdgpu/gc_11_0_4_mes.bin
    amdgpu/gc_11_0_4_pfp.bin
    amdgpu/gc_11_0_4_rlc.bin
    amdgpu/gc_9_4_3_mec.bin
    amdgpu/gc_9_4_3_rlc.bin
    amdgpu/psp_13_0_0_sos.bin
    amdgpu/psp_13_0_0_ta.bin
    amdgpu/psp_13_0_10_sos.bin
    amdgpu/psp_13_0_10_ta.bin
    amdgpu/psp_13_0_11_ta.bin
    amdgpu/psp_13_0_11_toc.bin
    amdgpu/psp_13_0_4_ta.bin
    amdgpu/psp_13_0_4_toc.bin
    amdgpu/psp_13_0_5_asd.bin
    amdgpu/psp_13_0_5_ta.bin
    amdgpu/psp_13_0_5_toc.bin
    amdgpu/psp_13_0_6_sos.bin
    amdgpu/psp_13_0_6_ta.bin
    amdgpu/psp_13_0_7_sos.bin
    amdgpu/psp_13_0_7_ta.bin
    amdgpu/psp_13_0_8_asd.bin
    amdgpu/psp_13_0_8_ta.bin
    amdgpu/psp_13_0_8_toc.bin
    amdgpu/sdma_4_4_2.bin
    amdgpu/sdma_5_2_6.bin
    amdgpu/sdma_5_2_7.bin
    amdgpu/sdma_6_0_0.bin
    amdgpu/sdma_6_0_1.bin
    amdgpu/sdma_6_0_2.bin
    amdgpu/sdma_6_0_3.bin
    amdgpu/smu_13_0_0.bin
    amdgpu/smu_13_0_10.bin
    amdgpu/smu_13_0_6.bin
    amdgpu/smu_13_0_7.bin
    amdgpu/vcn_3_1_2.bin
    amdgpu/vcn_4_0_0.bin
    amdgpu/vcn_4_0_2.bin
    amdgpu/vcn_4_0_3.bin
    amdgpu/vcn_4_0_4.bin
