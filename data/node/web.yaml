---
classes:
  - 'nest::node::web'
  - 'nest::service::bitwarden'
  - 'nest::service::gateway'
  - 'nest::service::reverse_proxy'
  - 'nest::service::wordpress'

nest::dvorak: true

nest::service::apache::manage_firewall: true

nest::service::gateway::port_forwards:
  git:
    dest: '104.156.227.40'
    port: 22
    proto: tcp
    to_addr: '172.22.0.1'
    to_port: 2222
  # streamlabs:
  #   dest: '104.156.227.40'
  #   port: 59650
  #   proto: tcp
  #   to_addr: '172.22.0.9'
  #   to_port: 59650

nest::service::reverse_proxy::hosts:
  gitlab.james.tl:
    destination: '172.22.0.1:8000'
    ip: ['104.156.227.40', '2001:19f0:300:2005::40']
    encoded_slashes: true
    timeout: 300
    websockets: true

  james.tl:
    destination: 'portfolio.eyrie'
    ip: ['104.156.227.40', '2001:19f0:300:2005::40']
    preserve_host: true
    priority: '20'  # higher priority
    serveraliases: ['www.james.tl']
    serve_local: true
    timeout: 600

  registry.gitlab.james.tl:
    destination: '172.22.0.1:5050'
    ip: ['104.156.227.40', '2001:19f0:300:2005::40']

  requests.thesatelliteoflove.net:
    destination: 'ombi.nest'
    ip: ['104.156.227.40', '2001:19f0:300:2005::40']
    serveraliases: ['requests.heloandnala.net']

  thestaticvoid.com:
    destination: 'thestaticvoid.eyrie'
    ip: ['104.156.227.40', '2001:19f0:300:2005::40']
    preserve_host: true
    serveraliases: ['www.thestaticvoid.com', 'thestaticvoid.org', 'www.thestaticvoid.org', 'tsv.co', 'www.tsv.co']
    serve_local: true
    timeout: 600

  vault.thesatelliteoflove.net:
    destination: '127.0.0.1:8080'
    ip: ['104.156.227.40', '2001:19f0:300:2005::40']
    websockets: '127.0.0.1:3012'
