---
.affinity: &affinity
  nodeAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      nodeSelectorTerms:
        - matchExpressions:
          - key: role
            operator: In
            values:
              - storage

.tolerations: &tolerations
  - key: role
    operator: Equal
    value: storage
    effect: NoSchedule

values:
  alertmanager:
    alertmanagerSpec:
      affinity: *affinity
      tolerations: *tolerations
  prometheusOperator:
    affinity: *affinity
    tolerations: *tolerations
  prometheus:
    prometheusSpec:
      serviceMonitorSelector:
        matchLabels: null # select all ServiceMonitors in the namespace
      affinity: *affinity
      tolerations: *tolerations

  # Subcharts
  # See: https://github.com/prometheus-community/helm-charts/blob/main/charts/kube-state-metrics/values.yaml
  # See: https://github.com/grafana/helm-charts/blob/main/charts/grafana/values.yaml
  kube-state-metrics:
    affinity: *affinity
    tolerations: *tolerations
  grafana:
    affinity: *affinity
    tolerations: *tolerations
