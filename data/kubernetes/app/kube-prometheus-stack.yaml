---
resources:
  # Disable Nest backup
  backup: {}

  # Define cert for Grafana
  certificate:
    apiVersion: cert-manager.io/v1
    kind: Certificate
    metadata:
      name: grafana-cert
      namespace: "%{nest::kubernetes::namespace}"
    spec:
      secretName: grafana-cert
      issuerRef:
        name: eyrie-ca
        kind: ClusterIssuer
      dnsNames:
        - "%{nest::kubernetes::namespace}-grafana.eyrie"

values:
  grafana:
    ingress:
      enabled: true
      ingressClassName: nginx
      hosts:
        -  "%{nest::kubernetes::namespace}-grafana.eyrie"
      tls:
        - hosts:
            -  "%{nest::kubernetes::namespace}-grafana.eyrie"
          secretName: grafana-cert
  prometheus:
    prometheusSpec:
      storageSpec:
       volumeClaimTemplate:
         spec:
           storageClassName: eagle
           accessModes: ["ReadWriteOnce"]
           resources:
             requests:
               storage: 50Gi
