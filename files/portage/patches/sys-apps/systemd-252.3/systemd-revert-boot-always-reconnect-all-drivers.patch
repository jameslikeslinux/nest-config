From db3a8a57996cfa2b74fedabc024eb3a5157c29ab Mon Sep 17 00:00:00 2001
From: James Lee <james@james.tl>
Date: Tue, 20 Dec 2022 15:50:21 -0500
Subject: [PATCH] Revert "boot: Always reconnect all drivers"

This reverts commit 1a9874905a900dc7d02bf4ef4c0a87931a5ad75c.
---
 src/boot/efi/boot.c | 7 -------
 1 file changed, 7 deletions(-)

diff --git a/src/boot/efi/boot.c b/src/boot/efi/boot.c
index 25a0215eb0..cd348bbdd6 100644
--- a/src/boot/efi/boot.c
+++ b/src/boot/efi/boot.c
@@ -2668,13 +2668,6 @@ EFI_STATUS efi_main(EFI_HANDLE image, EFI_SYSTEM_TABLE *sys_table) {
 
         export_variables(loaded_image, loaded_image_path, init_usec);
 
-        /* The firmware may skip initializing some devices for the sake of a faster boot. This is especially
-         * true for fastboot enabled firmwares. But this means that things we use like input devices or the
-         * xbootldr partition may not be available yet. Reconnect all drivers should hopefully make the
-         * firmware initialize everything we need. */
-        if (is_direct_boot(loaded_image->DeviceHandle))
-                (void) reconnect_all_drivers();
-
         err = open_volume(loaded_image->DeviceHandle, &root_dir);
         if (err != EFI_SUCCESS)
                 return log_error_status_stall(err, L"Unable to open root directory: %r", err);
-- 
2.37.4

